<?xml version="1.0" encoding="UTF-8"?>

<subsection xml:id="sec-piecewise-defined-functions" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Piecewise Defined Functions</title>
    <introduction>
        <p>
			In this section, we'll explore piecewise-defined functions, which 
			are functions constructed from pieces of several other functions. 
			We'll find the domain and range of these types of functions, as 
			well as graph, evaluate, and solve them. And given the graph of a 
			piecewise-defined function, we'll construct the formula for the 
			graph's function.
        </p>
    </introduction>

    <paragraphs>
        <title>Textbook Reference</title>
        <p> 
            This relates to content in <url href="https://openstax.org/books/algebra-and-trigonometry-2e/pages/3-2-domain-and-range">Section 3.2</url> of
            <url href="https://openstax.org/details/books/algebra-and-trigonometry-2e">Algebra and Trigonometry 2e</url>.
        </p>
    </paragraphs>

    <exercises xml:id="prep-piecewise-defined-functions">
		<title>Preparation Exercises</title>
		<exercisegroup>
			<title>Preparation 1</title>
			<introduction>
				<p>
		A family event charges $4/person, with a maximum of $20 for any single family.
				</p>
			</introduction>
			<exercise number="a">
				<statement>
					<p>How much will a family of three pay?</p>
				</statement>
			</exercise>
			<exercise number="b">
				<statement>
					<p>How much will a family of seven pay?</p>
				</statement>
			</exercise>
			<exercise number="c">
				<statement>
					<p>At what number of people does the calculation change from being per person to a single charge for the whole family?</p>
				</statement>
			</exercise>
		</exercisegroup>

		<exercisegroup>
			<title>Preparation 2</title>
			<introduction>
		<p>In November 2022, Portland General Electric set the rates for basic residential service as a function of the number of kilowatt-hours (kWh) of energy used. The rates in November 2022 were $0.0642/kWh when up to 1000 kWh (kilowatt-hours) are used and if greater than 1000 kWh are used, then the first 1000kWh are billed at the $0.0642/kWh rate and $0.07002/kWh is charged for the energy usage greater than the initial 1000 kWh.</p>
			</introduction>
			<exercise number="a">
				<statement>
					<p>What is the cost for using 740 kWh?</p>
				</statement>
			</exercise>
			<exercise number="b">
				<statement>
					<p>What is the cost for using 1320 kWh?</p>
				</statement>
			</exercise>
			<exercise number="c">
				<statement>
		<p>What is the formula to find the cost for using <m>x</m> kWh if <m>x</m> is greater than 1000 kWh?</p>
				</statement>
			</exercise>
		</exercisegroup>
	</exercises>
	<exercises xml:id="practice-piecewise-defined">
		<title>Practice Exercises</title>
		<exercisegroup>
			<title>Practice 1</title>
			<introduction>
				<p>
					Let 
					<m>f(x)=
						\begin{cases}
					x^2-4 \amp \text{if } {-2}\leq x \lt 3\\
					\frac{2}{3}x-1 \amp \text{if } x\geq 3
					\end{cases}
				</m>
				</p>
			</introduction>
			<exercise number="a">
				<p>Evaluate <m>f(5)</m>.</p>
			</exercise>
			<exercise number="b">
				<p>What is the domain of <m>f</m>?</p>
			</exercise>
			<exercise number="c">
				<p>Graph <m>y = f(x)</m> in <xref ref="graph-piecewise-1"/>.</p>
			</exercise>
		</exercisegroup>
                <figure xml:id="graph-piecewise-1">
                    <caption><m>y=f(x)</m></caption>
                    <image>
                        <latex-image>
                            <![CDATA[
                                \begin{tikzpicture}
                                \begin{axis}[
								framedaxes,
								xlabel={},
								ylabel={},
								xmin=-8,xmax=8,
								ymin=-8,ymax=8,
								xtick={-16,16},
								minor xtick={-17,...,17},
								ytick={-16,16},
								minor ytick={-17,...,17},
								grid=both
								]
                                \end{axis}
                                \end{tikzpicture}
                                ]]>
                        </latex-image>
                    </image>
                </figure>
		<exercisegroup>
			<title>Practice 2</title>
			<introduction>
				<p>
						The graph of <m>y=g(x)</m> is in <xref ref="graph-piecewise-2"/>.
				</p>
                <figure xml:id="graph-piecewise-2">
                    <caption><m>y=f(x)</m></caption>
                    <image>
                        <latex-image>
                            <![CDATA[
                                \begin{tikzpicture}
                                \begin{axis}[
								framedaxes,
 			xlabel={$x$},
 			ylabel={$y$},
 			xmin=-8,xmax=8,
 			ymin=-8,ymax=8,
		        xtick={-6,-4,...,6},
		       	minor xtick={-11,-9,-7,...,11},
		        ytick={-6,-4,...,6},
	         	minor ytick={-7,-5,...,7},
		         grid=both
 			]
 		% use TeX as calculator:
				\addplot[first,line width=1.5pt,samples=400,<-]expression[domain=-8:-3]{2/3*(x+3)+1};
					\addplot[first,smooth,mark=*,line width=1pt,fill=first]coordinates{	(-3,1)	};
					\addplot[first,smooth,mark=*,line width=1pt,fill=white]coordinates{	(-3,-4)	};
				\addplot[first,line width=1.5pt,samples=400,-]expression[domain=-3:1]{-4};
					\addplot[first,smooth,mark=*,line width=1pt,fill=white]coordinates{	(1,-4)	};
					\addplot[first,smooth,mark=*,line width=1pt,fill=first]coordinates{	(2,3)	};
				\addplot[first,line width=1.5pt,samples=400,->]expression[domain=2:7.5]{-2*(x-2)+3};
                                \end{axis}
                                \end{tikzpicture}
                                ]]>
                        </latex-image>
                    </image>
                </figure>
			</introduction>
			<exercise number="a">
				<p>Evaluate <m>g(-2)</m>.</p>
			</exercise>
			<exercise number="b">
				<p>Solve <m>g(x) = -1</m>.</p>
			</exercise>
			<exercise number="c">
				<p>What is the domain of <m>g</m>?</p>
			</exercise>
			<exercise number="d">
				<p>What is the range of <m>g</m>?</p>
			</exercise>
			<exercise number="e">
				<p>State the formula for the function <m>g</m>.</p>
			</exercise>
		</exercisegroup>
    </exercises>

    
    <subsubsection xml:id="definitions-piecewise-defined-functions">
        <title>Definitions</title>
        <definition>
            <title>Piecewise-Defined Functions</title>
            <statement>
                <p>
						A <term>piecewise-defined function</term> is a function which uses different formulas for calculating the output on different intervals of its domain.  Each formula is used on a distinct interval of the domain.</p>
					<p>
The notation we use to write a piecewise-defined function is:
					<me>f(x)=
					\begin{cases}
					\text{formula #1} \amp \textrm{if} \quad x \text{ is in this part of the domain of } f \\
					\text{formula #2} \amp \textrm{if} \quad x \text{ is in this other part of the domain of } f \\
					\text{etc.} \amp \textrm{if} \quad \text{etc.}
					\end{cases}
				</me>
				The domain of the function is the union of the intervals used by the separate formulas.
                </p>
            </statement>
			<example>
				<p>The function 
				<me>f(x)=
				\begin{cases}
				-\frac{1}{2}(x+3)^2+4 \amp \textrm{if}\quad -5 \lt x \leq 1 \\
				\sqrt{x-1}+3 \amp \textrm{if}\quad x \gt 1 \\
				\end{cases}
				</me>
				is a piece-wise defined function.
				</p>
				<p>
						Its graph is in <xref ref="graph-def-piecewise"/>.
				</p>
				<p> 
					Its domain is <m>(-5, \infty)</m> and its range is <m>[-4,\infty)</m>.		
				</p>
                <figure xml:id="graph-def-piecewise">
                    <caption><m>y=f(x)</m></caption>
                    <image>
                        <latex-image>
							<![CDATA[
								\begin{tikzpicture}
								\begin{axis}[
								framedaxes,
								height=5.5cm,
								width=5.5cm,
								xlabel={$x$},
								ylabel={$y$},
								xmin=-8,xmax=8,
								ymin=-8,ymax=8,
								xtick={-6,-4,...,6},
								minor xtick={-11,-9,-7,...,11},
								ytick={-6,-4,...,6},
								minor ytick={-7,-5,...,7},
								grid=both
								]
								% use TeX as calculator:
								\addplot[first,line width=1.5pt,samples=400,-]expression[domain=-5:1]{-0.5*(x+3)^2+4};
								\addplot[first,smooth,mark=*,line width=1pt,fill=white]coordinates{	(-5,2)	};
								\addplot[first,smooth,mark=*,line width=1pt,fill=first]coordinates{	(1,-4)	};
								\addplot[first,line width=1.5pt,samples=400,->]expression[domain=-1:8]{(x-1)^0.5+3};
								\addplot[first,smooth,mark=*,line width=1pt,fill=white]coordinates{	(1,3)	};
								\end{axis}
								\end{tikzpicture}
								]]>
                        </latex-image>
                    </image>
                </figure>
			</example>
        </definition>
	</subsubsection>
        
    <exercises xml:id="exit-piecewise-defined-functions">
        <title>Exit Exercises</title>
        <exercisegroup>
            <title>Exit 1</title>
			<introduction>
				<p>
						Use <m>F(x) = 
							\begin{cases}
							-\frac{1}{2}x^2+1 \amp \textrm{if} \quad x \leq 2 \\
							-\frac{1}{2}x + 5 \amp \textrm{if} \quad x \gt 4
							\end{cases}
					</m>
					to answer the following.
				</p>
			</introduction>
            <exercise number="a">
                <statement>
					<p>Evaluate <m>F(8)</m>.</p>
                </statement>
            </exercise>
            <exercise number="b">
                <statement>
					<p>Evaluate <m>F(-6)</m>.</p>
                </statement>
            </exercise>
        </exercisegroup>
        <exercisegroup>
            <title>Exit 2</title>
			<!--TODO: suppress numbering?-->
			<exercise>
				<statement>
					<p>
						In November 2022, Portland General Electric set the rates for basic residential service to be $0.0642/kWh for up to 1000 kWh used and then $0.07002/kWh for any usage greater than 1000 kWh.  Find a piecewise-defined function that gives the cost of electricity used (in dollars) as a function of <m>x</m>, the amount of kWh used.
					</p>
				</statement>
			</exercise>
        </exercisegroup>
        <exercisegroup>
            <title>Exit 3</title>
			<introduction>
				<p>
					<m>y = G(x)</m> is graphed in <xref ref="fig-exit-piecewise-2"/> below.
				</p>
                <figure xml:id="fig-exit-piecewise-2">
                    <caption><m>y=G(x)</m></caption>
                    <image>
                        <latex-image>
							<![CDATA[
								\begin{tikzpicture}
								\begin{axis}[
								framedaxes,
								height=7cm,
								width=7cm,
								xlabel={$x$},
								ylabel={$y$},
								xmin=-8,xmax=8,
								ymin=-8,ymax=8,
								xtick={-6,-4,...,6},
								minor xtick={-11,-9,-7,...,11},
								ytick={-6,-4,...,6},
								minor ytick={-7,-5,...,7},
								grid=both
								]
								% use TeX as calculator:
								\addplot[first,line width=1.5pt,samples=400,<-]expression[domain=-7.666:-4]{-3*(x+4)-3};
								\addplot[first,smooth,mark=*,line width=1pt,fill=first]coordinates{	(-4,-3)	};
								\addplot[first,smooth,mark=*,line width=1pt,fill=white]coordinates{	(-4,1)	};
								\addplot[first,line width=1.5pt,samples=400,-]expression[domain=-4:2]{3/4*(x+4)+1};
								\addplot[first,smooth,mark=*,line width=1pt,fill=white]coordinates{	(2,5.5)	};
								\addplot[first,smooth,mark=*,line width=1pt,fill=first]coordinates{	(3,3)	};
								\addplot[first,line width=1.5pt,samples=400,->]expression[domain=3:8]{-1*(x-3)+3};
								\end{axis}
								\end{tikzpicture}
								]]>
						</latex-image>
					</image>
				</figure>
			</introduction>
			<exercise number="a">
				<statement>
					<p>
							State the formula for the function <m>G</m>.
					</p>
				</statement>
			</exercise>
			<exercise number="b">
				<statement>
					<p>
							Evaluate <m>G(-4)</m> from the graph.
					</p>
				</statement>
			</exercise>
			<exercise number="c">
				<statement>
					<p>
							Solve <m>G(x) = 0</m> from the graph.
					</p>
				</statement>
			</exercise>
		</exercisegroup>
    </exercises>
    <exercise>
        <title>Reflection</title>
        <statement>
            <p>On a scale of 1-5, how are you feeling with the concepts related to the graphical behaviors of functions?</p>
        </statement>
    </exercise>
</subsection>
